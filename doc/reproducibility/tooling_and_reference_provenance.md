# Tooling and Reference Provenance

Checked on: 2026-02-25
Scope: `src/ddPCR`, `src/junctions`, `src/pipelines`

## Required CLI tools and versions

- `Rscript`: `Rscript (R) version 4.4`
- `bwa`: `Program: bwa (alignment via Burrows-Wheeler transformation) Version: 0.7.17-r1188`
- `samtools`: `samtools 1.19.2`
- `bedtools`: `bedtools v2.30.0`
- `gatk`: `The Genome Analysis Toolkit (GATK) v4.5.0.0`
- `tabix`: `tabix (htslib) 1.19.1`
- `python3`: `Python 3.11.6`

## Required R packages and versions

### Junction workflow (`src/junctions`)

- `GenomicFeatures`: `1.58.0`
- `GenomicRanges`: `1.58.0`
- `GenomeInfoDb`: `1.42.3`
- `Rsamtools`: `2.22.0`
- `Biostrings`: `2.74.1`
- `rtracklayer`: `1.66.0`
- `GenomicAlignments`: `1.42.0`
- `dplyr`: `1.1.4`
- `txdbmaker`: `1.2.0` (installed in dedicated reproducible env `prnp-junctions`; required by current `GenomicFeatures::makeTxDbFromGFF()` stack)

### ddPCR workflow (`src/ddPCR`)

- `binom`: `1.1.1.1`
- `dplyr`: `1.1.4`
- `magrittr`: `2.0.3`
- `readr`: `2.1.5`
- `stringr`: `1.5.1`
- `tidyverse`: `2.0.0`
- `tidyr`: `1.3.1`
- `tibble`: `3.2.1`
- `openxlsx`: `4.2.8`

## Required reference artefacts and provenance notes

| Artifact | Path | Current status | Provenance note |
|---|---|---|---|
| GRCh38 FASTA | `resources/hg38.fa` | Present | Source URL: `https://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/latest/hg38.fa.gz`; local file date: `2024-03-03` |
| Ensembl GTF release 110 | `resources/Homo_sapiens.GRCh38.110.gtf.gz` | Present | Source URL: `https://ftp.ensembl.org/pub/release-110/gtf/homo_sapiens/Homo_sapiens.GRCh38.110.gtf.gz`; local file date: `2023-04-24` |
| Junction FASTA | `resources/junctions/prnp_junctions.fa` | Present | Generated by `src/junctions/01_build_prnp_junction_fasta.R` |
| Junction padded BED | `resources/junctions/PRNP.pad1kb.hg38.bed` | Present | Generated by `src/junctions/02_make_prnp_bed.R` |
| Manual population frequency table | `resources/annotations/manual_population_freq.tsv` | Present | Curator: `Manfredi Carta`; git history dates: created `2026-02-22` (`ffd835d`), header fix `2026-02-22` (`8218429`) |
| gnomAD AF-only resource | `resources/somatic-hg38_af-only-gnomad.hg38.vcf.gz` | Present | Source URI: `gs://gatk-best-practices/somatic-hg38/af-only-gnomad.hg38.vcf.gz`; local file date: `2025-04-19` |
| 1000G PoN resource | `resources/somatic-hg38_1000g_pon.hg38.vcf.gz` | Present | Source URI: `gs://gatk-best-practices/somatic-hg38/1000g_pon.hg38.vcf.gz`; local file date: `2023-11-20` |
| dbSNP resource | `resources/dbsnp_146.hg38.vcf.gz` | Present | Source URI: `gs://genomics-public-data/resources/broad/hg38/v0/dbsnp_146.hg38.vcf.gz`; local file date: `2023-09-03` |
| Mills/1000G indels resource | `resources/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz` | Present | Source URI: `gs://genomics-public-data/resources/broad/hg38/v0/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz`; local file date: `2023-09-03` |

## Untracked resource files and how to obtain them

The following resource paths are required by active workflows but are intentionally not tracked in git.
Place them at the exact repo-relative paths shown below.

### SNV pipeline workflow (`src/pipelines`)

- `resources/chr2_chr4_chr20.fasta`
  - This is a subset of hg38 containing only chromosomes 2, 4 and 20 (which contain TTN, TET2 and PRNP, respectively). The subset was used to decrease computation time in the somatic mutation pipeline.
  - Obtain: derive from hg38 by extracting `chr2`, `chr4`, `chr20` from `resources/hg38.fa` (e.g. with `samtools faidx`)
  - Reconstruction (from repository root):
    - `samtools faidx resources/hg38.fa chr2 chr4 chr20 > resources/chr2_chr4_chr20.fasta`
    - `samtools faidx resources/chr2_chr4_chr20.fasta`
    - `gatk CreateSequenceDictionary -R resources/chr2_chr4_chr20.fasta -O resources/chr2_chr4_chr20.dict`
    - `bwa index resources/chr2_chr4_chr20.fasta`
  - Required sidecars expected by scripts:
    - `resources/chr2_chr4_chr20.fasta.fai`
    - `resources/chr2_chr4_chr20.dict`
    - `resources/chr2_chr4_chr20.fasta.amb`
    - `resources/chr2_chr4_chr20.fasta.ann`
    - `resources/chr2_chr4_chr20.fasta.bwt`
    - `resources/chr2_chr4_chr20.fasta.pac`
    - `resources/chr2_chr4_chr20.fasta.sa`
- `resources/dbsnp_146.hg38.vcf.gz` and index
  - Obtain from: `gs://genomics-public-data/resources/broad/hg38/v0/dbsnp_146.hg38.vcf.gz`
  - Required index: `resources/dbsnp_146.hg38.vcf.gz.tbi`
- `resources/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz` and index
  - Obtain from: `gs://genomics-public-data/resources/broad/hg38/v0/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz`
  - Required index: `resources/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz.tbi`
- `resources/somatic-hg38_af-only-gnomad.hg38.vcf.gz` and index
  - Obtain from: `gs://gatk-best-practices/somatic-hg38/af-only-gnomad.hg38.vcf.gz`
  - Required index: `resources/somatic-hg38_af-only-gnomad.hg38.vcf.gz.tbi` (or `.csi`)
- `resources/somatic-hg38_1000g_pon.hg38.vcf.gz` and index (optional, only if using provided PoN resource file)
  - Obtain from: `gs://gatk-best-practices/somatic-hg38/1000g_pon.hg38.vcf.gz`
  - Required index: `resources/somatic-hg38_1000g_pon.hg38.vcf.gz.tbi` (or `.csi`)
- Funcotator datasource tree
  - Required path: `resources/funcotator_data_somatic/funcotator_dataSources.v1.8.hg38.20230908s/hg38`
  - Obtain: download and unpack the corresponding Funcotator datasources so that this exact directory exists.

### Junction workflow (`src/junctions`)

- `resources/hg38.fa`
  - Obtain: download GRCh38 FASTA from UCSC (`https://hgdownload.soe.ucsc.edu/goldenPath/hg38/bigZips/latest/hg38.fa.gz`), then decompress to `resources/hg38.fa`.
- `resources/Homo_sapiens.GRCh38.110.gtf.gz`
  - Obtain: download Ensembl release 110 GTF (`https://ftp.ensembl.org/pub/release-110/gtf/homo_sapiens/Homo_sapiens.GRCh38.110.gtf.gz`) to `resources/`.
- Runtime-generated sidecars for `resources/junctions/prnp_junctions.fa`:
  - `resources/junctions/prnp_junctions.fa.amb`
  - `resources/junctions/prnp_junctions.fa.ann`
  - `resources/junctions/prnp_junctions.fa.bwt`
  - `resources/junctions/prnp_junctions.fa.pac`
  - `resources/junctions/prnp_junctions.fa.sa`
  - Obtain: generated automatically by `src/junctions/03_process_bam.sh` via `bwa index` (do not download manually).

## Notes

- `tidyverse` and `openxlsx` are currently installed in base conda R (not in `prnp-somatic` env) for compatibility reasons.
